#summary How to extend the Lemon-Tree code to add new functionalities.
#labels Java,code,extending

= Introduction =

We strongly encourage people to extend the functionalities of Lemon-Tree, by extending the codebase. Here, we describe the basic data structures and give some guidelines, assuming that the reader knows the fundamentals of programming in Java.


= Details =

== Javadoc ==

The complete java documentation (javadoc) is available for [https://drive.google.com/folderview?id=0Bzj0HOAsmfNwd1NHOTFpcjM2eXc&usp=sharing download] from the home page. Most of the classes properties and functions are commented, so it is probably good idea to start browsing around this documentation.

== Adding new functions ==

Let us take a concrete example of how to extend Lemon-Tree to add a new clustering algorithm and a new regulator assignment algorithm.

A good entry point to understand how the code is organized and how it is working is to look at the class {{{RunCli}}}, which is parsing all the commands and creating objects and calling functions according to the different options specified for the task chosen.

Parsing of the tasks is done within {{{if}}} blocks, like this entry for the "ganesh" task:
{{{
// ---------------------------------------------------------------
// ganesh task: 2-way clustering of genes using the gibbs sampler
// ---------------------------------------------------------------
if (task.equalsIgnoreCase("ganesh")) {
}}}
 In the body of the function, we can see that the clustering procedure is done in 5 essential steps:

  * creation of an a {{{ModuleNetwork}}} object.
  * read data matrix.
  * initialization of clustering parameters.
  * two-way probabilistic clustering. 
  * write results to output file.


{{{
// Create ModuleNetwork object
ModuleNetwork M = new ModuleNetwork();
M.setNormalGammaPriors(lambda, mu, alpha, beta);
M.readExpressionMatrix(data_file, gene_file);
M.setNormalGammaPriors(lambda, mu, alpha, beta);
// Gibbs sample different module sets with one tree per module
M.gibbsSamplerGenes(init_num_clust, num_runs, num_steps, burn_in, sample_steps, score_gain, use_bayesian_score);
// write results to text file
M.writeClusters(output_file);
}}}